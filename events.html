<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>الفعاليات - دليل فعاليات المدينة</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/css/styles.css" />
    <!--Font Awesome-->

    <script
      src="https://kit.fontawesome.com/1b6501c143.js"
      crossorigin="anonymous"
    ></script>
  </head>
  <body class="bg-light">
    <header>
      <main-navbar></main-navbar>
    </header>

    <main class="container my-4">
      <section class="mb-4">
        <h2 class="h4 mb-3">كل الفعاليات</h2>
        <div class="mb-3">
          <select
            id="categoryFilter"
            class="form-select w-auto d-inline-block me-2"
          >
            <option value="">جميع التصنيفات</option>
            <option value="ثقافة">ثقافة</option>
            <option value="رياضة">رياضة</option>
            <option value="موسيقى">موسيقى</option>
            <option value="عائلي">عائلي</option>
          </select>
          <input
            type="date"
            id="dateFilter"
            class="form-control w-auto d-inline-block me-2"
          />
          <button id="filterBtn" class="btn btn-primary">فلترة</button>
        </div>
        <div id="eventsList" class="row row-cols-1 row-cols-md-3 g-4">
          <!-- Events will be dynamically loaded here -->
        </div>
      </section>
    </main>

    <main-footer></main-footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/main.js"></script>

    <!-- JavaScript المدمج -->
    <script>
      // بيانات الفعاليات
      const events = [
        {
          id: 1,
          title: "معرض فني",
          date: "2025-09-20",
          location: "معرض الفنون",
          category: "ثقافة",
          description:
            "هذا المعرض يعرض لوحات فنية من فنانين محليين، مع ورش عمل وجولات إرشادية.",
          image: "https://placehold.co/600x400?text=معرض+فني",
          related: [5, 3],
        },
        {
          id: 2,
          title: "مباراة كرة قدم",
          date: "2025-09-22",
          location: "الاستاد",
          category: "رياضة",
          description: "مباراة محلية بين فرق شهيرة.",
          image: "https://placehold.co/600x400?text=مباراة+كرة+قدم",
          related: [6],
        },
        {
          id: 3,
          title: "حفل موسيقي",
          date: "2025-09-25",
          location: "القاعة الكبرى",
          category: "موسيقى",
          description: "حفل لفرقة شهيرة.",
          image: "https://placehold.co/600x400?text=حفل+موسيقي",
          related: [1],
        },
        {
          id: 4,
          title: "يوم عائلي",
          date: "2025-09-28",
          location: "الحديقة",
          category: "عائلي",
          description: "أنشطة للعائلات.",
          image: "https://placehold.co/600x400?text=يوم+عائلي",
          related: [],
        },
        {
          id: 5,
          title: "محاضرة ثقافية",
          date: "2025-10-01",
          location: "الجامعة",
          category: "ثقافة",
          description: "محاضرة عن التاريخ.",
          image: "https://placehold.co/600x400?text=محاضرة+ثقافية",
          related: [1],
        },
        {
          id: 6,
          title: "سباق رياضي",
          date: "2025-10-05",
          location: "الملعب",
          category: "رياضة",
          description: "سباق جري.",
          image: "https://placehold.co/600x400?text=سباق+رياضي",
          related: [2],
        },
      ];

      // دالة عرض الفعاليات
      function displayEvents(filteredEvents) {
        const eventsList = document.getElementById("eventsList");
        eventsList.innerHTML = "";
        filteredEvents.forEach((event) => {
          const col = document.createElement("div");
          col.className = "col event-item";
          col.innerHTML = `
                  <div class="card h-100">
                    <img src="${event.image}" alt="${
            event.title
          }" class="card-img-top">
                    <div class="card-body">
                      <h5 class="card-title">${event.title}</h5>
                      <p class="card-text">تاريخ: ${event.date
                        .split("-")
                        .reverse()
                        .join("-")}، مكان: ${event.location}، تصنيف: ${
            event.category
          }</p>
                      <p class="card-text">${event.description.substring(
                        0,
                        50
                      )}...</p>
                      <a href="event.html?id=${
                        event.id
                      }" class="btn btn-primary">التفاصيل</a>
                    </div>
                  </div>
                `;
          eventsList.appendChild(col);
        });
      }

      // تنفيذ بعد تحميل DOM
      document.addEventListener("DOMContentLoaded", function () {
        // عرض كل الفعاليات بشكل افتراضي
        displayEvents(events);

        // الفلترة
        const filterBtn = document.getElementById("filterBtn");
        if (filterBtn) {
          filterBtn.addEventListener("click", function () {
            const category = document.getElementById("categoryFilter").value;
            const date = document.getElementById("dateFilter").value;
            const filtered = events.filter(
              (e) =>
                (!category || e.category === category) &&
                (!date || e.date === date)
            );
            displayEvents(filtered);
          });
        }

        // فلترة حسب الرابط URL إذا موجود
        const urlParams = new URLSearchParams(window.location.search);
        const categoryParam = urlParams.get("category");
        if (categoryParam) {
          document.getElementById("categoryFilter").value = categoryParam;
          const filtered = events.filter((e) => e.category === categoryParam);
          displayEvents(filtered);
        }
      });
    </script>
  </body>
</html>
